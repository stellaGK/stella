
!-------------------------------
!----------  Geometry ----------
!-------------------------------

&geo_knobs
   geo_option = 'local'
   overwrite_bmag = .false.
   overwrite_gradpar = .false.
   overwrite_gds2 = .false.
   overwrite_gds21 = .false.
   overwrite_gds22 = .false.
   overwrite_gds23 = .false.
   overwrite_gds24 = .false.
   overwrite_gbdrift = .false.
   overwrite_cvdrift = .false.
   overwrite_gbdrift0 = .false.
   set_bmag_const = .false.
   q_as_x = .false.
   geo_file = 'input.geometry'
/

&vmec_parameters
   vmec_filename = 'wout.nc'
   alpha0 = 0.0
   zeta_center = 0.0
   nfield_periods = -1.0
   torflux = 0.6354167d+0
   surface_option = 0
   verbose = .true.
   gradpar_zeta_prefac = 1.0
   zgrid_scalefac = 1.0
/

&millergeo_parameters
   nzed_local = 128
   rhoc = 0.5
   rhoc0 = 0.5
   rmaj = 3.0
   rgeo = 3.0
   qinp = 1.4
   shat = 0.8
   shift = 0.0
   kappa = 0.0
   kapprim = 0.0
   tri = 0.0
   triprim = 0.0
   betaprim = 0.0
   betadbprim = 0.0
   d2qdr2 = 0.0
   d2psidr2 = 0.0
   read_profile_variation = .false.
   write_profile_variation = .false.
   load_psi0_variables = .true.
   rhotor = rhoc
   psitor_lcfs = 1.0
   drhotordrho = 1.0
/

!-------------------------------
!----------  Physics  ----------
!-------------------------------

&parameters
   beta = 0.0
   vnew_ref = -1.0
   rhostar = -1.0
   irhostar = -1.0
   zeff = 1.0
   tite = 1.0
   nine = 1.0 
   g_exb = 0.0
   g_exbfac = 1.0
   omprimfac = 1.0
/

&physics_flags
   full_flux_surface = .false.
   radial_variation = .false.
   include_pressure_variation = .true.
   include_geometric_variation = .true.
   include_parallel_nonlinearity = .false.
   include_parallel_streaming = .true.
   include_mirror = .true.
   nonlinear = .false.
   adiabatic_option = 'no-field-line-average-term'
   const_alpha_geo = .false.
/

!-------------------------------
!-----------  Grids  -----------
!-------------------------------

&vpamu_grids_parameters
   nvgrid = 24
   vpa_max = 3.0
   nmu = 12
   vperp_max = 3.0
   equally_spaced_mu_grid = .false.
   conservative_wgts_vpa = .false.
/

&zgrid_parameters
   nzed = 24
   nperiod = 1
   ntubes = 1
   boundary_option = 'zero'
   zed_equal_arc = .false.
   shat_zero = 1.e-5
   grad_x_grad_y_zero = 1.e-5
/

&species_knobs
   nspec = 2
   read_profile_variation = .false.
   write_profile_variation = .false.
   species_option = 'stella'
   ecoll_zeff = .false.
/

&species_parameters_1
   z = 1
   mass = 1.0
   dens = 1.0
   temp = 1.0
   tprim = -999.9
   fprim = -999.9
   d2ndr2 = 0.0
   d2Tdr2 = 0.0
   bess_fac = 1.0
   type = 'ion'
/

&euterpe_parameters
   nradii = 1000
   data_file = 'euterpe.dat'
/

&kt_grids_knobs
   grid_option = 'range'
/

&kt_grids_box_parameters
   nx = 1
   ny = 1
   jtwist = -1
   jtwistfac = 1.
   phase_shift_angle = 0.
   x0 = -1.0
   y0 = -1.0
   nalpha = 1
   centered_in_rho = .true.
   randomize_phase_shift = .false.
   periodic_variation = .false.
/

&kt_grids_range_parameters
   nalpha = 1
   naky = 1
   nakx = 1
   aky_min = 0.0
   aky_max = 0.0
   akx_min = 0.0
   akx_max = -1.0
   theta0_min = 0.0
   theta0_max = -1.0
   phase_shift_angle = 0.
/

!--------------------------------
!---------  Diagnostics  --------
!--------------------------------

&stella_diagnostics_knobs
   nwrite = 50
   navg = 50
   nsave = -1
   save_for_restart = .false.
   write_omega = .false.
   write_phi_vs_time = .false.
   write_gvmus = .false.
   write_gzvs = .false.
   write_kspectra = .false.
   write_moments = .false.
   write_radial_fluxes = .false.
   write_radial_moments = .false.
   write_fluxes_kxkyz = .false.
   nc_mult = 1
   flux_norm = .true.
/

!--------------------------------
!--------  Init fields  ---------
!--------------------------------

&init_g_knobs
   tstart = 0.
   scale = 1.0
   ginit_option = 'default'
   width0 = -3.5
   refac = 1.
   imfac = 0.
   den0 = 1.
   upar0 = 0.
   tpar0 = 0.
   tperp0 = 0.
   den1 = 0.
   upar1 = 0.
   tpar1 = 0.
   tperp1 = 0.
   den2 = 0.
   upar2 = 0.
   tpar2 = 0.
   tperp2 = 0.
   phiinit = 1.0
   zf_init = 1.0
   kxmax = 1.e100
   kxmin = 0.
   chop_side = .false.
   scale_to_phiinit = .false.
   left = .true.
   even = .true.
   restart_file = '.nc'
   restart_dir = './'
/

!-------------------------------
!--------  Dissipation  --------
!-------------------------------

&dissipation
   include_collisions = .false.
   collisions_implicit = .true.
   collision_model = 'dougherty'
   testpart = .true.
   fieldpart = .false.
   intraspec = .true.
   interspec = .true.
   iiknob = 1.
   ieknob = 1.
   eeknob = 1.
   eiknob = 1.
   eiediffknob = 1.
   deflknob = 1.
   eimassr_approx = .false.
   advfield_coll = .true.
   density_conservation = .false.
   density_conservation_field = .false.
   density_conservation_tp = .false.
   exact_conservation = .false.
   momentum_conservation = .true.
   energy_conservation = .true.
   spitzer_problem = .false.
   cfac = 1
   cfac2 = 1
   nuxfac = 1
   jmax = 1
   lmax = 1
   i1fac = 1
   i2fac = 0
   no_j1l1 = .true.
   no_j1l2 = .false.
   no_j0l2 = .false.
   vpa_operator = .true.
   mu_operator = .true.
   hyper_dissipation = .false.
   nvel_local = 512
   D_hyper = 0.05
/

!-------------------------------
!----------  Numerics  ---------
!-------------------------------
! Note that <delt> does not have a default value!

&knobs
   delt = -1
   fphi = 1.0
   fapar = 1.0
   fbpar = -1.0
   fields_kxkyz = .false.
   stream_implicit = .true.
   mirror_implicit = .true.
   drifts_implicit = .false.
   driftkinetic_implicit = .false.
   maxwellian_inside_zed_derivative = .false.
   mirror_semi_lagrange = .true.
   mirror_linear_interp = .false.
   stream_matrix_inversion = .false.
   delt_option = 'check_restart'
   lu_option = 'none'
   zed_upwind = 0.02
   vpa_upwind = 0.02
   time_upwind = 0.02
   avail_cpu_time = 1.e10
   cfl_cushion = 0.5
   delt_adjust = 2.0
   delt_max = -1
   rng_seed = -1 
   ky_solve_radial = 0
   ky_solve_real = .false.
   mat_gen = .true.
   mat_read = .false.
   tend = -1.0
   nstep = -1
/

&time_advance_knobs
   explicit_option = 'rk3'
   xdriftknob = 1.0
   ydriftknob = 1.0
   wstarknob = 1.0
   flip_flop = .false.
/

!-------------------------------
!--------  Neoclassics  --------
!-------------------------------

&neoclassical_input
   include_neoclassical_terms = .false.
   nradii = 5
   drho = 0.01
   neo_option = 'sfincs'
/

&sfincs_input
   read_sfincs_output_from_file = .false.
   nproc_sfincs = 1
   calculate_radial_electric_field = .true.
   includeXDotTerm = .true.
   includeElectricFieldTermInXiDot = .true.
   magneticDriftScheme = 0
   includePhi1 = .true.
   includePhi1InKineticEquation = .false.
   geometryScheme = 1
   VMECRadialOption = 0
   equilibriumFile = 'wout_161s1.nc'
   coordinateSystem = 3
   inputRadialCoordinate = 3
   inputRadialCoordinateForGradients = 3
   aHat = 1.0
   Delta = -1.0
   nu_n = -1.0
   dPhiHatdrN = -9999.9
   Er_window = 0.3
   nxi = 48
   nx = 12
   Ntheta = 65
   Nzeta = 1
/

!--------------------------------
!------  Radial variation  ------
!--------------------------------

&multibox_parameters 
   boundary_size = 4
   krook_size = 0
   phi_bound = 0
   phi_pow = 0
   krook_exponent = 0.0
   krook_efold = 3.0
   nu_krook_mb = 0.0
   mb_debug_step = 1000
   smooth_ZFs = .false.
   comm_at_init = .false.
   RK_step = .false.
   zf_option = 'default'
   krook_option = 'linear'
   LR_debug_option = 'default'
   use_dirichlet_BC = .false.
/

&sources
   include_krook_operator = .false.
   exclude_boundary_regions = .false.
   exclude_boundary_regions_qn = .false.
   remove_zero_projection = .false.
   nu_krook = 0.05
   tcorr_source = 0.02
   tcorr_source_qn = 0.0
   ikxmax_source = 1
   krook_odd = .true.
   from_zero = .true.
   conserve_momentum = .false.
   conserve_density = .false.
/

!--------------------------------
!-------  Parallelisation  ------
!--------------------------------

&layouts_knobs
   xyzs_layout = 'xyzs'
   vms_layout = 'vms'
/




