!===============================================================================
!                               Magnetic Geometry                               
!===============================================================================

&geometry_options
  geometry_option = 'miller'
/
&geometry_miller
  nzed_local = 128
  rhoc = 0.5
  rmaj = 3.0
  rgeo = 3.0
  qinp = 2.0
  shat = 1.0
  shift = 0.0 
  kappa = 1.0
  kapprim = 0.0
  tri = 0.0
  triprim = 0.0
  betaprim = 0.0089
  d2qdr2 = 0.0
  d2psidr2 = 0.0
  betadbprim = 0.0
/

!===============================================================================
!                                    Physics                                    
!===============================================================================

&gyrokinetic_terms
  include_parallel_streaming = .true.
  include_mirror = .true.
  include_xdrift = .true.
  include_ydrift = .true.
  include_drive = .true.
  include_nonlinear = .false.
  include_parallel_nonlinearity = .false.
  include_electromagnetic = .true.
/

&electromagnetic
  include_apar = .true.
  include_bpar = .false.
  beta = 0.001
/

!===============================================================================
!                                Kinetic species                                
!===============================================================================

&species_options
  nspec = 3
  species_option = 'stella'
/
&species_parameters_1
  z = 1.0
  mass = 1.0
  dens = 0.95
  temp = 1.0
  tprim = 3.0
  fprim = 1.0
  type = 'ion'
/

&species_parameters_2
  z = -1.0
  mass = 0.00027
  dens = 1.0
  temp = 1.0
  tprim = 3.0
  fprim = 1.0
  type = 'electron'
/

&species_parameters_3
  z = 2.0
  mass = 2.0
  dens = 0.025
  temp = 100.0
  fprim = 16.0
  tprim = 0.0
  type = 'ion'
/

!===============================================================================
!                       Discretized (kx,ky,z,mu,vpa) grid                       
!===============================================================================

&kxky_grid_option
  grid_option='range'
/
&kxky_grid_range
  naky = 1
  aky_min = 0.08
  aky_max = 0.08
  akx_min = 0.0
  akx_max = 0.0
/
&z_grid
  nzed = 6
  nperiod = 3
/
&z_boundary_condition
  boundary_option = 'default'
/
&velocity_grids
  nvgrid = 8
  nmu = 6
  vpa_max = 3.0
/

!===============================================================================
!                                  Diagnostics                                  
!===============================================================================

&stella_diagnostics_knobs
  nwrite = 200
  nsave = 3000 
  save_for_restart = .false.
  write_omega = .true.
  write_phi_vs_time = .true.
  write_apar_vs_time = .true. 
  write_gvmus = .false.
  write_gzvs = .false.
/

!===============================================================================
!                              Initialise potential                             
!===============================================================================

&initialise_distribution
  initialise_distribution_option = 'default'
  phiinit = 1.0
  scale_to_phiinit = .true.
/
&initialise_distribution_maxwellian
  width0 = 1.0
/

!===============================================================================
!                                    Numerics                                   
!===============================================================================

&time_trace_options
  tend = 12.0
/

&time_step
  delt = 0.005
/

&numerical_algorithms
  explicit_algorithm = 'rk3'
  mirror_semi_lagrange = .false.
  stream_implicit = .true.
  mirror_implicit = .true.
  drifts_implicit = .false.
/

&numerical_extra
  print_extra_info_to_terminal = .false.
/

&numerical_upwinding_for_derivatives
  zed_upwind = 0.0
  time_upwind = 0.0
  vpa_upwind = 0.0
/
