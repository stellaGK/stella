<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="stella is a flux tube gyrokinetic code for micro-stability and turbulence simulations of strongly magnetised plasma">
    <meta name="author" content="The stella team" >
    <link rel="icon" href="../favicon.png">

    <title>stella_diagnostics &ndash; stella</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">stella </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>README</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>stella_diagnostics 
    <small>Module</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 3.0% of total for modules and submodules.">1151 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/stella_diagnostics.f90"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/stella_diagnostics.f90.html'>stella_diagnostics.f90</a></li>
     <li class="active">stella_diagnostics</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars-0">Variables</a></h3></div>
  <div id="vars-0" class="panel-collapse collapse">
    <div class="list-group">
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-ntg_out">ntg_out</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-nwrite">nwrite</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-nsave">nsave</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-navg">navg</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-nc_mult">nc_mult</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-stdout_unit">stdout_unit</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-fluxes_unit">fluxes_unit</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-omega_unit">omega_unit</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-save_for_restart">save_for_restart</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-write_omega~3">write_omega</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-write_moments~3">write_moments</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-write_phi_vs_time">write_phi_vs_time</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-write_gvmus~3">write_gvmus</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-write_gzvs~3">write_gzvs</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-write_kspectra~3">write_kspectra</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-write_radial_fluxes~3">write_radial_fluxes</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-write_radial_moments~3">write_radial_moments</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-write_fluxes_kxkyz">write_fluxes_kxkyz</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-flux_norm">flux_norm</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-pflux_avg">pflux_avg</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-vflux_avg">vflux_avg</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-qflux_avg">qflux_avg</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-heat_avg">heat_avg</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-pflux~2">pflux</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-vflux~2">vflux</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-qflux~2">qflux</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-exchange">exchange</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-omega_vs_time">omega_vs_time</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-nout~13">nout</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-diagnostics_initialized">diagnostics_initialized</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-debug~6">debug</a>
    </div>
  </div>
</div>
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#subs-0">Subroutines</a></h3></div>
  <div class="list-group">
    <div id="subs-0" class="panel-collapse collapse">
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-init_stella_diagnostics">init_stella_diagnostics</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-read_parameters~2">read_parameters</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-allocate_arrays">allocate_arrays</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-open_loop_ascii_files">open_loop_ascii_files</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-close_loop_ascii_files">close_loop_ascii_files</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-diagnose_stella">diagnose_stella</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-get_fluxes">get_fluxes</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-get_fluxes_vmulo">get_fluxes_vmulo</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-get_fluxes_ffs">get_fluxes_ffs</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-get_one_flux_ffs">get_one_flux_ffs</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-get_modified_fourier_coefficient">get_modified_fourier_coefficient</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-get_one_flux">get_one_flux</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-get_one_flux_vmulo">get_one_flux_vmulo</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-get_one_flux_radial">get_one_flux_radial</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-get_moments">get_moments</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-get_moments_ffs">get_moments_ffs</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-g_to_f">g_to_f</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-get_gvmus">get_gvmus</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-get_gzvs">get_gzvs</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-finish_stella_diagnostics">finish_stella_diagnostics</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-write_loop_ascii_files">write_loop_ascii_files</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-write_final_ascii_files">write_final_ascii_files</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-deallocate_arrays">deallocate_arrays</a>
    </div>
  </div>
</div>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <p>Routines for calculating and writing various physical diagnostics</p>
    
    
    <br>

    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars-1">Variables</a></h3></div>
  <div id="vars-1" class="panel-collapse collapse">
    <div class="list-group">
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-ntg_out">ntg_out</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-nwrite">nwrite</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-nsave">nsave</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-navg">navg</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-nc_mult">nc_mult</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-stdout_unit">stdout_unit</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-fluxes_unit">fluxes_unit</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-omega_unit">omega_unit</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-save_for_restart">save_for_restart</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-write_omega~3">write_omega</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-write_moments~3">write_moments</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-write_phi_vs_time">write_phi_vs_time</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-write_gvmus~3">write_gvmus</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-write_gzvs~3">write_gzvs</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-write_kspectra~3">write_kspectra</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-write_radial_fluxes~3">write_radial_fluxes</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-write_radial_moments~3">write_radial_moments</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-write_fluxes_kxkyz">write_fluxes_kxkyz</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-flux_norm">flux_norm</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-pflux_avg">pflux_avg</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-vflux_avg">vflux_avg</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-qflux_avg">qflux_avg</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-heat_avg">heat_avg</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-pflux~2">pflux</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-vflux~2">vflux</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-qflux~2">qflux</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-exchange">exchange</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-omega_vs_time">omega_vs_time</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-nout~13">nout</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-diagnostics_initialized">diagnostics_initialized</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#variable-debug~6">debug</a>
    </div>
  </div>
</div>
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#subs-1">Subroutines</a></h3></div>
  <div class="list-group">
    <div id="subs-1" class="panel-collapse collapse">
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-init_stella_diagnostics">init_stella_diagnostics</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-read_parameters~2">read_parameters</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-allocate_arrays">allocate_arrays</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-open_loop_ascii_files">open_loop_ascii_files</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-close_loop_ascii_files">close_loop_ascii_files</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-diagnose_stella">diagnose_stella</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-get_fluxes">get_fluxes</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-get_fluxes_vmulo">get_fluxes_vmulo</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-get_fluxes_ffs">get_fluxes_ffs</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-get_one_flux_ffs">get_one_flux_ffs</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-get_modified_fourier_coefficient">get_modified_fourier_coefficient</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-get_one_flux">get_one_flux</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-get_one_flux_vmulo">get_one_flux_vmulo</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-get_one_flux_radial">get_one_flux_radial</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-get_moments">get_moments</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-get_moments_ffs">get_moments_ffs</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-g_to_f">g_to_f</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-get_gvmus">get_gvmus</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-get_gzvs">get_gzvs</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-finish_stella_diagnostics">finish_stella_diagnostics</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-write_loop_ascii_files">write_loop_ascii_files</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-write_final_ascii_files">write_final_ascii_files</a>
      <a class="list-group-item" href="../module/stella_diagnostics.html#proc-deallocate_arrays">deallocate_arrays</a>
    </div>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">


    <section>
    <h2>Variables</h2>
    <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Visibility</th><th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" id="variable-ntg_out"></span>integer,</td>
<td>private</td>  <td></td><td>::</td>
  <td><strong>ntg_out</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nwrite"></span>integer,</td>
<td>private</td>  <td></td><td>::</td>
  <td><strong>nwrite</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nsave"></span>integer,</td>
<td>public</td>  <td></td><td>::</td>
  <td><strong>nsave</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-navg"></span>integer,</td>
<td>private</td>  <td></td><td>::</td>
  <td><strong>navg</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nc_mult"></span>integer,</td>
<td>private</td>  <td></td><td>::</td>
  <td><strong>nc_mult</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-stdout_unit"></span>integer,</td>
<td>private</td>  <td></td><td>::</td>
  <td><strong>stdout_unit</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-fluxes_unit"></span>integer,</td>
<td>private</td>  <td></td><td>::</td>
  <td><strong>fluxes_unit</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-omega_unit"></span>integer,</td>
<td>private</td>  <td></td><td>::</td>
  <td><strong>omega_unit</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-save_for_restart"></span>logical,</td>
<td>private</td>  <td></td><td>::</td>
  <td><strong>save_for_restart</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-write_omega~3"></span>logical,</td>
<td>private</td>  <td></td><td>::</td>
  <td><strong>write_omega</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-write_moments~3"></span>logical,</td>
<td>private</td>  <td></td><td>::</td>
  <td><strong>write_moments</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-write_phi_vs_time"></span>logical,</td>
<td>private</td>  <td></td><td>::</td>
  <td><strong>write_phi_vs_time</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-write_gvmus~3"></span>logical,</td>
<td>private</td>  <td></td><td>::</td>
  <td><strong>write_gvmus</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-write_gzvs~3"></span>logical,</td>
<td>private</td>  <td></td><td>::</td>
  <td><strong>write_gzvs</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-write_kspectra~3"></span>logical,</td>
<td>private</td>  <td></td><td>::</td>
  <td><strong>write_kspectra</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-write_radial_fluxes~3"></span>logical,</td>
<td>private</td>  <td></td><td>::</td>
  <td><strong>write_radial_fluxes</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-write_radial_moments~3"></span>logical,</td>
<td>private</td>  <td></td><td>::</td>
  <td><strong>write_radial_moments</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-write_fluxes_kxkyz"></span>logical,</td>
<td>private</td>  <td></td><td>::</td>
  <td><strong>write_fluxes_kxkyz</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-flux_norm"></span>logical,</td>
<td>private</td>  <td></td><td>::</td>
  <td><strong>flux_norm</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-pflux_avg"></span>real,</td>
<td>private,</td>  <td>dimension(:), allocatable</td><td>::</td>
  <td><strong>pflux_avg</strong></td><td></td><td></td><td><p>Arrays needed for averaging in x,y,z</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-vflux_avg"></span>real,</td>
<td>private,</td>  <td>dimension(:), allocatable</td><td>::</td>
  <td><strong>vflux_avg</strong></td><td></td><td></td><td><p>Arrays needed for averaging in x,y,z</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-qflux_avg"></span>real,</td>
<td>private,</td>  <td>dimension(:), allocatable</td><td>::</td>
  <td><strong>qflux_avg</strong></td><td></td><td></td><td><p>Arrays needed for averaging in x,y,z</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-heat_avg"></span>real,</td>
<td>private,</td>  <td>dimension(:), allocatable</td><td>::</td>
  <td><strong>heat_avg</strong></td><td></td><td></td><td><p>Arrays needed for averaging in x,y,z</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-pflux~2"></span>real,</td>
<td>private,</td>  <td>dimension(:, :, :), allocatable</td><td>::</td>
  <td><strong>pflux</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-vflux~2"></span>real,</td>
<td>private,</td>  <td>dimension(:, :, :), allocatable</td><td>::</td>
  <td><strong>vflux</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-qflux~2"></span>real,</td>
<td>private,</td>  <td>dimension(:, :, :), allocatable</td><td>::</td>
  <td><strong>qflux</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-exchange"></span>real,</td>
<td>private,</td>  <td>dimension(:, :, :), allocatable</td><td>::</td>
  <td><strong>exchange</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-omega_vs_time"></span>complex,</td>
<td>private,</td>  <td>dimension(:, :, :), allocatable</td><td>::</td>
  <td><strong>omega_vs_time</strong></td><td></td><td></td><td><p>Needed for calculating growth rates and frequencies</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nout~13"></span>integer,</td>
<td>private</td>  <td></td><td>::</td>
  <td><strong>nout</strong></td><td> =</td><td>1</td><td><p>Current maximum index of the time dimension in the netCDF file</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-diagnostics_initialized"></span>logical,</td>
<td>private</td>  <td></td><td>::</td>
  <td><strong>diagnostics_initialized</strong></td><td> =</td><td>.false.</td><td><p>Has this module been initialised?</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-debug~6"></span>logical,</td>
<td>private</td>  <td></td><td>::</td>
  <td><strong>debug</strong></td><td> =</td><td>.false.</td><td><p>Debugging</p></td>
</tr>
</tbody>
</table>

    </section>
    <br>
    
    

    
    

    <section>
    <h2>Subroutines</h2>
      <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-init_stella_diagnostics"></span><h3>public subroutine <a href='../proc/init_stella_diagnostics.html'>init_stella_diagnostics</a>(restart, tstart)</h3></div>
  <div class="panel-body">
       
<p>Initialise the <a href="../module/stella_diagnostics.html">stella_diagnostics</a> module</p><a href="../proc/init_stella_diagnostics.html" class="pull-right"><emph>Read more&hellip;</emph></a>
    
<h4>Arguments</h4>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>logical,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>restart</strong></td><td><p>Has this simulation been restarted?</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>tstart</strong></td><td><p>Current simulation time</p></td>
</tr>
</tbody>
</table>


  </div>
  </div>

      <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-read_parameters~2"></span><h3>private subroutine <a href='../proc/read_parameters~2.html'>read_parameters</a>()</h3></div>
  <div class="panel-body">
       
<p>Read the diagnostic input parameters from the input file</p><a href="../proc/read_parameters~2.html" class="pull-right"><emph>Read more&hellip;</emph></a>
    
<h4>Arguments</h4>      <em>None</em>

  </div>
  </div>

      <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-allocate_arrays"></span><h3>private subroutine <a href='../proc/allocate_arrays.html'>allocate_arrays</a>()</h3></div>
  <div class="panel-body">
       
<p>Allocate the module-level arrays</p>
    
<h4>Arguments</h4>      <em>None</em>

  </div>
  </div>

      <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-open_loop_ascii_files"></span><h3>private subroutine <a href='../proc/open_loop_ascii_files.html'>open_loop_ascii_files</a>(restart)</h3></div>
  <div class="panel-body">
       
<p>Open the '.out' and the '.fluxes' file.</p><a href="../proc/open_loop_ascii_files.html" class="pull-right"><emph>Read more&hellip;</emph></a>
    
<h4>Arguments</h4>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>logical,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>restart</strong></td><td></td>
</tr>
</tbody>
</table>


  </div>
  </div>

      <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-close_loop_ascii_files"></span><h3>private subroutine <a href='../proc/close_loop_ascii_files.html'>close_loop_ascii_files</a>()</h3></div>
  <div class="panel-body">
       
<p>Close the text files opened by <a href="../proc/open_loop_ascii_files.html">open_loop_ascii_files</a></p>
    
<h4>Arguments</h4>      <em>None</em>

  </div>
  </div>

      <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-diagnose_stella"></span><h3>public subroutine <a href='../proc/diagnose_stella.html'>diagnose_stella</a>(istep)</h3></div>
  <div class="panel-body">
       
<p>Calculate and write diagnostics</p><a href="../proc/diagnose_stella.html" class="pull-right"><emph>Read more&hellip;</emph></a>
    
<h4>Arguments</h4>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>istep</strong></td><td><p>The current timestep</p></td>
</tr>
</tbody>
</table>


  </div>
  </div>

      <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-get_fluxes"></span><h3>private subroutine <a href='../proc/get_fluxes.html'>get_fluxes</a>(g, pflx, vflx, qflx, pflx_vs_kxkyz, vflx_vs_kxkyz, qflx_vs_kxkyz)</h3></div>
  <div class="panel-body">
       
<p>Calculate fluxes</p><a href="../proc/get_fluxes.html" class="pull-right"><emph>Read more&hellip;</emph></a>
    
<h4>Arguments</h4>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>complex,</td>
<td>intent(in),</td>
  <td></td>  <td>dimension(:, :, kxkyz_lo%llim_proc:)</td><td>::</td>
  <td><strong>g</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(out),</td>
  <td></td>  <td>dimension(:)</td><td>::</td>
  <td><strong>pflx</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(out),</td>
  <td></td>  <td>dimension(:)</td><td>::</td>
  <td><strong>vflx</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(out),</td>
  <td></td>  <td>dimension(:)</td><td>::</td>
  <td><strong>qflx</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(out),</td>
  <td></td>  <td>dimension(:, :, -nzgrid:, :, :)</td><td>::</td>
  <td><strong>pflx_vs_kxkyz</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(out),</td>
  <td></td>  <td>dimension(:, :, -nzgrid:, :, :)</td><td>::</td>
  <td><strong>vflx_vs_kxkyz</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(out),</td>
  <td></td>  <td>dimension(:, :, -nzgrid:, :, :)</td><td>::</td>
  <td><strong>qflx_vs_kxkyz</strong></td><td></td>
</tr>
</tbody>
</table>


  </div>
  </div>

      <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-get_fluxes_vmulo"></span><h3>private subroutine <a href='../proc/get_fluxes_vmulo.html'>get_fluxes_vmulo</a>(g, phi, pflx, vflx, qflx, pflx_x, vflx_x, qflx_x)</h3></div>
  <div class="panel-body">
           
<h4>Arguments</h4>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>complex,</td>
<td>intent(in),</td>
  <td></td>  <td>dimension(:, :, -nzgrid:, :, vmu_lo%llim_proc:)</td><td>::</td>
  <td><strong>g</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>complex,</td>
<td>intent(in),</td>
  <td></td>  <td>dimension(:, :, -nzgrid:, :)</td><td>::</td>
  <td><strong>phi</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(out),</td>
  <td></td>  <td>dimension(:)</td><td>::</td>
  <td><strong>pflx</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(out),</td>
  <td></td>  <td>dimension(:)</td><td>::</td>
  <td><strong>vflx</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(out),</td>
  <td></td>  <td>dimension(:)</td><td>::</td>
  <td><strong>qflx</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(out),</td>
  <td></td>  <td>dimension(:, :)</td><td>::</td>
  <td><strong>pflx_x</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(out),</td>
  <td></td>  <td>dimension(:, :)</td><td>::</td>
  <td><strong>vflx_x</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(out),</td>
  <td></td>  <td>dimension(:, :)</td><td>::</td>
  <td><strong>qflx_x</strong></td><td></td>
</tr>
</tbody>
</table>


  </div>
  </div>

      <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-get_fluxes_ffs"></span><h3>private subroutine <a href='../proc/get_fluxes_ffs.html'>get_fluxes_ffs</a>(dens, upar, pres, pflx, vflx, qflx, pflx_vs_kxkyz, vflx_vs_kxkyz, qflx_vs_kxkyz)</h3></div>
  <div class="panel-body">
       
<p>Calculate the total particle, momentum and heat fluxes (pflx, vflx, qflx)
and the contributions from a given (kx,ky,z) location (pflx_kxkyz, vflx_kxkyz, qflx_kxkyz)
inputs are the particle density (dens), parallel flow (upar) and pressure (pres)</p><a href="../proc/get_fluxes_ffs.html" class="pull-right"><emph>Read more&hellip;</emph></a>
    
<h4>Arguments</h4>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>complex,</td>
<td>intent(in),</td>
  <td></td>  <td>dimension(:, :, -nzgrid:, :)</td><td>::</td>
  <td><strong>dens</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>complex,</td>
<td>intent(in),</td>
  <td></td>  <td>dimension(:, :, -nzgrid:, :)</td><td>::</td>
  <td><strong>upar</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>complex,</td>
<td>intent(in),</td>
  <td></td>  <td>dimension(:, :, -nzgrid:, :)</td><td>::</td>
  <td><strong>pres</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(out),</td>
  <td></td>  <td>dimension(:)</td><td>::</td>
  <td><strong>pflx</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(out),</td>
  <td></td>  <td>dimension(:)</td><td>::</td>
  <td><strong>vflx</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(out),</td>
  <td></td>  <td>dimension(:)</td><td>::</td>
  <td><strong>qflx</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(out),</td>
  <td></td>  <td>dimension(:, :, -nzgrid:, :, :)</td><td>::</td>
  <td><strong>pflx_vs_kxkyz</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(out),</td>
  <td></td>  <td>dimension(:, :, -nzgrid:, :, :)</td><td>::</td>
  <td><strong>vflx_vs_kxkyz</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(out),</td>
  <td></td>  <td>dimension(:, :, -nzgrid:, :, :)</td><td>::</td>
  <td><strong>qflx_vs_kxkyz</strong></td><td></td>
</tr>
</tbody>
</table>


  </div>
  </div>

      <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-get_one_flux_ffs"></span><h3>private subroutine <a href='../proc/get_one_flux_ffs.html'>get_one_flux_ffs</a>(mom, dphidy, flxfac, flx, flx_vs_kxkyz)</h3></div>
  <div class="panel-body">
       
<p>divide the input density by the magnetic field strength (due to Jacobian in flux-surfacee avg)
and Fourier transform in y to get mom_ky = (density/B)(ky,kx,z,spec)
pflx_vs_kxkyz is the particle flux before summing over (kx,ky) and integrating over z
calculate the volume average of the particle flux
note that the factor of 1/B that appears in the Jacobian has already been taken into account
in the numerator of the flux surface average</p>
    
<h4>Arguments</h4>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>complex,</td>
<td>intent(in),</td>
  <td></td>  <td>dimension(:, :, -nzgrid:, :)</td><td>::</td>
  <td><strong>mom</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>complex,</td>
<td>intent(in),</td>
  <td></td>  <td>dimension(:, :, -nzgrid:)</td><td>::</td>
  <td><strong>dphidy</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>flxfac</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(out),</td>
  <td></td>  <td>dimension(:)</td><td>::</td>
  <td><strong>flx</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(out),</td>
  <td></td>  <td>dimension(:, :, -nzgrid:, :)</td><td>::</td>
  <td><strong>flx_vs_kxkyz</strong></td><td></td>
</tr>
</tbody>
</table>


  </div>
  </div>

      <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-get_modified_fourier_coefficient"></span><h3>private subroutine <a href='../proc/get_modified_fourier_coefficient.html'>get_modified_fourier_coefficient</a>(moment, moment_ky)</h3></div>
  <div class="panel-body">
       
<p>divide the input moment by the magnetic field strength
to account for Jacobian in flux-surface average
transform the B-modified input moment from y to ky space
swap from all ky and kx &gt;= 0 to all kx and ky &gt;= 0</p>
    
<h4>Arguments</h4>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>complex,</td>
<td>intent(in),</td>
  <td></td>  <td>dimension(:, :, -nzgrid:, :)</td><td>::</td>
  <td><strong>moment</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>complex,</td>
<td>intent(out),</td>
  <td></td>  <td>dimension(:, :, -nzgrid:, :)</td><td>::</td>
  <td><strong>moment_ky</strong></td><td></td>
</tr>
</tbody>
</table>


  </div>
  </div>

      <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-get_one_flux"></span><h3>private subroutine <a href='../proc/get_one_flux.html'>get_one_flux</a>(iky, iz, norm, gin, fld, flxout)</h3></div>
  <div class="panel-body">
           
<h4>Arguments</h4>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>iky</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>iz</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>norm</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>complex,</td>
<td>intent(in),</td>
  <td></td>  <td>dimension(:, :)</td><td>::</td>
  <td><strong>gin</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>complex,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>fld</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>flxout</strong></td><td></td>
</tr>
</tbody>
</table>


  </div>
  </div>

      <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-get_one_flux_vmulo"></span><h3>private subroutine <a href='../proc/get_one_flux_vmulo.html'>get_one_flux_vmulo</a>(weights, gin, fld, flxout)</h3></div>
  <div class="panel-body">
           
<h4>Arguments</h4>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(in),</td>
  <td></td>  <td>dimension(:)</td><td>::</td>
  <td><strong>weights</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>complex,</td>
<td>intent(in),</td>
  <td></td>  <td>dimension(:, :, -nzgrid:, :, vmu_lo%llim_proc:)</td><td>::</td>
  <td><strong>gin</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>complex,</td>
<td>intent(in),</td>
  <td></td>  <td>dimension(:, :, -nzgrid:, :)</td><td>::</td>
  <td><strong>fld</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(inout),</td>
  <td></td>  <td>dimension(:)</td><td>::</td>
  <td><strong>flxout</strong></td><td></td>
</tr>
</tbody>
</table>


  </div>
  </div>

      <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-get_one_flux_radial"></span><h3>private subroutine <a href='../proc/get_one_flux_radial.html'>get_one_flux_radial</a>(weights, gin, fld, flxout)</h3></div>
  <div class="panel-body">
           
<h4>Arguments</h4>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(in),</td>
  <td></td>  <td>dimension(:)</td><td>::</td>
  <td><strong>weights</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>complex,</td>
<td>intent(in),</td>
  <td></td>  <td>dimension(:, :, -nzgrid:, :, vmu_lo%llim_proc:)</td><td>::</td>
  <td><strong>gin</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>complex,</td>
<td>intent(in),</td>
  <td></td>  <td>dimension(:, :, -nzgrid:, :)</td><td>::</td>
  <td><strong>fld</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(inout),</td>
  <td></td>  <td>dimension(:, :)</td><td>::</td>
  <td><strong>flxout</strong></td><td></td>
</tr>
</tbody>
</table>


  </div>
  </div>

      <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-get_moments"></span><h3>private subroutine <a href='../proc/get_moments.html'>get_moments</a>(g, dens, upar, temp, dens_x, upar_x, temp_x, spitzer2)</h3></div>
  <div class="panel-body">
           
<h4>Arguments</h4>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>complex,</td>
<td>intent(in),</td>
  <td></td>  <td>dimension(:, :, -nzgrid:, :, vmu_lo%llim_proc:)</td><td>::</td>
  <td><strong>g</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>complex,</td>
<td>intent(out),</td>
  <td></td>  <td>dimension(:, :, -nzgrid:, :, :)</td><td>::</td>
  <td><strong>dens</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>complex,</td>
<td>intent(out),</td>
  <td></td>  <td>dimension(:, :, -nzgrid:, :, :)</td><td>::</td>
  <td><strong>upar</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>complex,</td>
<td>intent(out),</td>
  <td></td>  <td>dimension(:, :, -nzgrid:, :, :)</td><td>::</td>
  <td><strong>temp</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(out),</td>
  <td></td>  <td>dimension(:, :)</td><td>::</td>
  <td><strong>dens_x</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(out),</td>
  <td></td>  <td>dimension(:, :)</td><td>::</td>
  <td><strong>upar_x</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(out),</td>
  <td></td>  <td>dimension(:, :)</td><td>::</td>
  <td><strong>temp_x</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>complex,</td>
<td>intent(out),</td>
  <td></td>  <td>dimension(:, :, -nzgrid:, :, :)</td><td>::</td>
  <td><strong>spitzer2</strong></td><td></td>
</tr>
</tbody>
</table>


  </div>
  </div>

      <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-get_moments_ffs"></span><h3>private subroutine <a href='../proc/get_moments_ffs.html'>get_moments_ffs</a>(g, dens, upar, pres)</h3></div>
  <div class="panel-body">
       
<p>species-dependent factor by which velocity moments must be multiplied
to get density, pressure, etc.
the guiding centre distribution function, normalized by
the equilibrium Maxwellian, is passed in as g.
to obtain moments such as density, flow and pressure,
we need to take moments of the distribution function, f,
which is related to g via
f/F0 = g + (Ze/T)*(<phi>_R - phi)
obtain g0=f/F0 in Fourier space</p><a href="../proc/get_moments_ffs.html" class="pull-right"><emph>Read more&hellip;</emph></a>
    
<h4>Arguments</h4>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>complex,</td>
<td>intent(in),</td>
  <td></td>  <td>dimension(:, :, -nzgrid:, :, vmu_lo%llim_proc:)</td><td>::</td>
  <td><strong>g</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>complex,</td>
<td>intent(out),</td>
  <td></td>  <td>dimension(:, :, -nzgrid:, :)</td><td>::</td>
  <td><strong>dens</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>complex,</td>
<td>intent(out),</td>
  <td></td>  <td>dimension(:, :, -nzgrid:, :)</td><td>::</td>
  <td><strong>upar</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>complex,</td>
<td>intent(out),</td>
  <td></td>  <td>dimension(:, :, -nzgrid:, :)</td><td>::</td>
  <td><strong>pres</strong></td><td></td>
</tr>
</tbody>
</table>


  </div>
  </div>

      <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-g_to_f"></span><h3>private subroutine <a href='../proc/g_to_f.html'>g_to_f</a>(g, phi, f)</h3></div>
  <div class="panel-body">
       
<p>the Fourier components of the guiding centre distribution function
normalized by the equilibrium Maxwellian is passed in as g,
along with the Fourier components of the electrostatic potential, phi.
g_to_f calculates the Maxwellian-normalized distribution function f,
which is related to g via
f = g + (Ze/T)*(<phi>_R - phi)</p><a href="../proc/g_to_f.html" class="pull-right"><emph>Read more&hellip;</emph></a>
    
<h4>Arguments</h4>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>complex,</td>
<td>intent(in),</td>
  <td></td>  <td>dimension(:, :, -nzgrid:, :, vmu_lo%llim_proc:)</td><td>::</td>
  <td><strong>g</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>complex,</td>
<td>intent(in),</td>
  <td></td>  <td>dimension(:, :, -nzgrid:, :)</td><td>::</td>
  <td><strong>phi</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>complex,</td>
<td>intent(out),</td>
  <td></td>  <td>dimension(:, :, -nzgrid:, :, vmu_lo%llim_proc:)</td><td>::</td>
  <td><strong>f</strong></td><td></td>
</tr>
</tbody>
</table>


  </div>
  </div>

      <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-get_gvmus"></span><h3>private subroutine <a href='../proc/get_gvmus.html'>get_gvmus</a>(g, gv)</h3></div>
  <div class="panel-body">
           
<h4>Arguments</h4>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>complex,</td>
<td>intent(in),</td>
  <td></td>  <td>dimension(:, :, kxkyz_lo%llim_proc:)</td><td>::</td>
  <td><strong>g</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(out),</td>
  <td></td>  <td>dimension(:, :, :)</td><td>::</td>
  <td><strong>gv</strong></td><td></td>
</tr>
</tbody>
</table>


  </div>
  </div>

      <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-get_gzvs"></span><h3>private subroutine <a href='../proc/get_gzvs.html'>get_gzvs</a>(g, gz)</h3></div>
  <div class="panel-body">
           
<h4>Arguments</h4>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>complex,</td>
<td>intent(in),</td>
  <td></td>  <td>dimension(:, :, -nzgrid:, :, vmu_lo%llim_proc:)</td><td>::</td>
  <td><strong>g</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(out),</td>
  <td></td>  <td>dimension(:, :, :, :)</td><td>::</td>
  <td><strong>gz</strong></td><td></td>
</tr>
</tbody>
</table>


  </div>
  </div>

      <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-finish_stella_diagnostics"></span><h3>public subroutine <a href='../proc/finish_stella_diagnostics.html'>finish_stella_diagnostics</a>(istep)</h3></div>
  <div class="panel-body">
           
<h4>Arguments</h4>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>istep</strong></td><td></td>
</tr>
</tbody>
</table>


  </div>
  </div>

      <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-write_loop_ascii_files"></span><h3>private subroutine <a href='../proc/write_loop_ascii_files.html'>write_loop_ascii_files</a>(istep, phi2, apar2, pflx, vflx, qflx, om, om_avg)</h3></div>
  <div class="panel-body">
           
<h4>Arguments</h4>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>istep</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>phi2</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>apar2</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(in),</td>
  <td></td>  <td>dimension(:)</td><td>::</td>
  <td><strong>pflx</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(in),</td>
  <td></td>  <td>dimension(:)</td><td>::</td>
  <td><strong>vflx</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>real,</td>
<td>intent(in),</td>
  <td></td>  <td>dimension(:)</td><td>::</td>
  <td><strong>qflx</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>complex,</td>
<td>intent(in),</td>
  <td></td>  <td>dimension(:, :)</td><td>::</td>
  <td><strong>om</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>complex,</td>
<td>intent(in),</td>
  <td></td>  <td>dimension(:, :)</td><td>::</td>
  <td><strong>om_avg</strong></td><td></td>
</tr>
</tbody>
</table>


  </div>
  </div>

      <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-write_final_ascii_files"></span><h3>private subroutine <a href='../proc/write_final_ascii_files.html'>write_final_ascii_files</a>()</h3></div>
  <div class="panel-body">
           
<h4>Arguments</h4>      <em>None</em>

  </div>
  </div>

      <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-deallocate_arrays"></span><h3>private subroutine <a href='../proc/deallocate_arrays.html'>deallocate_arrays</a>()</h3></div>
  <div class="panel-body">
           
<h4>Arguments</h4>      <em>None</em>

  </div>
  </div>

    </section>    
    <br>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>stella was developed by The stella team<br>&copy; 2022 
<br /><small>v0.5-19-g42eb903d1</small></p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2022-03-09T09:51:47.932706           </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>