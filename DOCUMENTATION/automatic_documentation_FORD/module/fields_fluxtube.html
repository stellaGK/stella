<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="stella is a flux tube gyrokinetic code for micro-stability and turbulence simulations of strongly magnetised plasma">
    <meta name="author" content="The stella team" >
    <link rel="icon" href="../favicon.png">

    <title>fields_fluxtube &ndash; stella</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
      <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">stella </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" href="../page/index.html">Manual</a></li>
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/namelists.html">Namelists</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/programs.html">Programs</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>fields_fluxtube
      <small>Module</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 1.1% of total for modules and submodules.">305 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/fields_fluxtube.fpp"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/fields_fluxtube.fpp.html'>fields_fluxtube.fpp</a></li>
            <li class="breadcrumb-item active" aria-current="page">fields_fluxtube</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-bs-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>

  <div class="row">
    <div class="col-md-3">
        <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#vars-0"
         aria-expanded="false" aria-controls="vars-0">
         <h4 class="card-header bg-primary text-white">Variables</h4>
      </a>
      <div id="vars-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../module/fields_fluxtube.html#variable-zm~2">zm</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#inters-0"
         aria-expanded="false" aria-controls="inters-0">
         <h4 class="card-header bg-primary text-white">Interfaces</h4>
      </a>
      <div id="inters-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../module/fields_fluxtube.html#interface-get_fields_fluxtube">get_fields_fluxtube</a>
        </div>
      </div>
    </div>

  
  
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#subs-0"
         aria-expanded="false" aria-controls="subs-0">
         <h4 class="card-header bg-primary text-white">Subroutines</h4>
      </a>
      <div id="subs-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../module/fields_fluxtube.html#proc-advance_fields_fluxtube">advance_fields_fluxtube</a>
            <a class="list-group-item" href="../module/fields_fluxtube.html#proc-get_fields_fluxtube_vmlo">get_fields_fluxtube_vmlo</a>
            <a class="list-group-item" href="../module/fields_fluxtube.html#proc-get_fields_fluxtube_kxkyzlo">get_fields_fluxtube_kxkyzlo</a>
            <a class="list-group-item" href="../module/fields_fluxtube.html#proc-get_phi">get_phi</a>
            <a class="list-group-item" href="../module/fields_fluxtube.html#proc-init_fields_fluxtube">init_fields_fluxtube</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  


  </div>

    </div>

    <div class="col-md-9" id='text'>
      <p>Module for advancing and initialising the fields for a fluxtube simulation</p>
<p>Advance fields for fluxtube routines
Initialise Routine</p>
<br>          <div class="card mb-4">
      <h3 class="card-header card-title bg-light">Uses</h3>
      <div class="card-body">
        <ul class="list-group list-group-flush">
            <li class="list-group-item">
              <ul class="list-inline">
                  <li class="list-inline-item"><a href='debug_flags.html'>debug_flags</a></li>
              </ul>
            </li>
        </ul>
      </div>
    </div>

      
      <br>


        <section>
          <h2>Variables</h2>
            <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-zm~2"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>zm</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

        </section>
        <br>


        <section>
          <h2>Interfaces</h2>
              <div class="card">
    <div class="card-header bg-light codesum">
      <span class="anchor" id="interface-get_fields_fluxtube"></span>
      <h3>public        interface <a href='../interface/get_fields_fluxtube.html'>get_fields_fluxtube</a> 
      </h3>
    </div>
    <ul class="list-group">
          <li class="list-group-item">
                <h3>
    private  subroutine <a href='../proc/get_fields_fluxtube_vmlo.html'>get_fields_fluxtube_vmlo</a>(g, phi, apar, bpar, dist, skip_fsa)  

    </h3>
    
  <p>If we are parallelising over (vpa,mu) then this subroutine is called
This is the more common version used compared with parallelising over
(kx,ky,z) and is the default for stella.
Here we calculate:
   sum_s int dv (J0 * g)
and then call get_phi which divides this by the appropriate gamtot factor
TODO-GA: remove apar from this and make it only needed for EM stella</p>
<p>Layouts
Arrays
Parameters
Grids
Calculations
Routines from other field modules
Note that this advances phi for the electrostatic, fluxtube case.
If electromagnetic effects are included then phi will be advanced below
First gyroaverage the distribution function g at each phase space location
and store this as g_scratch = <g> = J_0 g in k-space
If we are allowing for Radial Variation then we must modify <g>.
This is done in the fields_radialvariation module, but is not needed
for standard stella (as these are false by default).
Next, integrate <g> over velocity space and sum over species and store
the result in phi, which will be further modified below to account for polarization term
Get phi routine inverts the appropriate 'Gamma_0' factor that multiplies the <phi> terms
onto the RHS of the equation. The exact form of this factor depends on the simulation
e.g. we may have adiabatic electrons, kinetic electrons etc. and also if Radial Varation
effects are included (these are false by default)
This is the inversion routine for electrostatic, fluxtube stella
If we are allowing for radial variation this factor changes further
If we have electromagnetic effects we need to add the terms due to A_parallel and B_parallel
and also need to advance phi including electromagnetic effects</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-g~108"></span>
              complex,
            </td>
<td>intent(in),</td>
              <td></td>            <td>
              dimension(:, :, -nzgrid:, :, vmu_lo%llim_proc:)
            </td>
            <td>::</td>
            <td><strong>g</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-phi~50"></span>
              complex,
            </td>
<td>intent(out),</td>
              <td></td>            <td>
              dimension(:, :, -nzgrid:, :)
            </td>
            <td>::</td>
            <td><strong>phi</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-apar~34"></span>
              complex,
            </td>
<td>intent(out),</td>
              <td></td>            <td>
              dimension(:, :, -nzgrid:, :)
            </td>
            <td>::</td>
            <td><strong>apar</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-bpar~31"></span>
              complex,
            </td>
<td>intent(out),</td>
              <td></td>            <td>
              dimension(:, :, -nzgrid:, :)
            </td>
            <td>::</td>
            <td><strong>bpar</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-dist~15"></span>
              character(len=*),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>dist</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-skip_fsa~4"></span>
              logical,
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>skip_fsa</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


          </li>
          <li class="list-group-item">
                <h3>
    private  subroutine <a href='../proc/get_fields_fluxtube_kxkyzlo.html'>get_fields_fluxtube_kxkyzlo</a>(g, phi, apar, bpar, dist, skip_fsa)  

    </h3>
    
  <p>If we are parallelising over (kx,ky,z) then this subroutine is called
This is the less common version used compared with parallelising over
(vpa, mu). This is NOT the default routine for stella, and the flag
<fields_kxkyz = .True.> must be set to use this routine.
Here we calculate:
   sum_s int dv (J0 * g)
and then call get_phi which divides this by the appropriate gamtot factor
TODO-GA: remove apar from this and make it only needed for EM stella</p>
<p>Layouts
Arrays
Parameters
Grids
Calculations
Routines from other field modules
Note that this advances phi for the electrostatic, fluxtube case.
If electromagnetic effects are included then phi will be advanced below
First gyroaverage the distribution function g at each phase space location
and store this as g0 = <g> = J_0 g in k-space
Next, integrate <g> over velocity space and sum over species and store
the result in phi, which will be further modified below to account for polarization term
If we are allowing for radial variation this factor changes further
If we have electromagnetic effects we need to add the terms due to A_parallel and B_parallel
and also need to advance phi including electromagnetic effects</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-g~109"></span>
              complex,
            </td>
<td>intent(in),</td>
              <td></td>            <td>
              dimension(:, :, kxkyz_lo%llim_proc:)
            </td>
            <td>::</td>
            <td><strong>g</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-phi~51"></span>
              complex,
            </td>
<td>intent(inout),</td>
              <td></td>            <td>
              dimension(:, :, -nzgrid:, :)
            </td>
            <td>::</td>
            <td><strong>phi</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-apar~35"></span>
              complex,
            </td>
<td>intent(inout),</td>
              <td></td>            <td>
              dimension(:, :, -nzgrid:, :)
            </td>
            <td>::</td>
            <td><strong>apar</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-bpar~32"></span>
              complex,
            </td>
<td>intent(inout),</td>
              <td></td>            <td>
              dimension(:, :, -nzgrid:, :)
            </td>
            <td>::</td>
            <td><strong>bpar</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-dist~16"></span>
              character(len=*),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>dist</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-skip_fsa~5"></span>
              logical,
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>skip_fsa</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


          </li>
    </ul>
  </div>

        </section>
        <br>




        <section>
          <h2>Subroutines</h2>
              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-advance_fields_fluxtube"></span> <h3>public  subroutine <a href='../proc/advance_fields_fluxtube.html'>advance_fields_fluxtube</a>(g, phi, apar, bpar, dist, skip_fsa)  
</h3></div>
    <div class="card-body">
          
  <p>This calls the appropriate routines needed to advance phi in the main code
when using fluxtube stella, depending on the distribution (i.e. if the
information is parallelised over (kx,ky,z) or (vpa,mu) ).
Note that Apar and Bpar are only advanced when using EM so these are in
fields_electromagnetic.fpp</p><a href="../proc/advance_fields_fluxtube.html" class="pull-right"><emph>Read more&hellip;</emph></a>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-g~107"></span>
              complex,
            </td>
<td>intent(in),</td>
              <td></td>            <td>
              dimension(:, :, -nzgrid:, :, vmu_lo%llim_proc:)
            </td>
            <td>::</td>
            <td><strong>g</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-phi~49"></span>
              complex,
            </td>
<td>intent(inout),</td>
              <td></td>            <td>
              dimension(:, :, -nzgrid:, :)
            </td>
            <td>::</td>
            <td><strong>phi</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-apar~33"></span>
              complex,
            </td>
<td>intent(inout),</td>
              <td></td>            <td>
              dimension(:, :, -nzgrid:, :)
            </td>
            <td>::</td>
            <td><strong>apar</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-bpar~30"></span>
              complex,
            </td>
<td>intent(inout),</td>
              <td></td>            <td>
              dimension(:, :, -nzgrid:, :)
            </td>
            <td>::</td>
            <td><strong>bpar</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-dist~14"></span>
              character(len=*),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>dist</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-skip_fsa~3"></span>
              logical,
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>skip_fsa</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-get_fields_fluxtube_vmlo"></span> <h3>private  subroutine <a href='../proc/get_fields_fluxtube_vmlo.html'>get_fields_fluxtube_vmlo</a>(g, phi, apar, bpar, dist, skip_fsa)  
</h3></div>
    <div class="card-body">
          
  <p>If we are parallelising over (vpa,mu) then this subroutine is called
This is the more common version used compared with parallelising over
(kx,ky,z) and is the default for stella.
Here we calculate:
   sum_s int dv (J0 * g)
and then call get_phi which divides this by the appropriate gamtot factor
TODO-GA: remove apar from this and make it only needed for EM stella</p><a href="../proc/get_fields_fluxtube_vmlo.html" class="pull-right"><emph>Read more&hellip;</emph></a>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-g~108"></span>
              complex,
            </td>
<td>intent(in),</td>
              <td></td>            <td>
              dimension(:, :, -nzgrid:, :, vmu_lo%llim_proc:)
            </td>
            <td>::</td>
            <td><strong>g</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-phi~50"></span>
              complex,
            </td>
<td>intent(out),</td>
              <td></td>            <td>
              dimension(:, :, -nzgrid:, :)
            </td>
            <td>::</td>
            <td><strong>phi</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-apar~34"></span>
              complex,
            </td>
<td>intent(out),</td>
              <td></td>            <td>
              dimension(:, :, -nzgrid:, :)
            </td>
            <td>::</td>
            <td><strong>apar</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-bpar~31"></span>
              complex,
            </td>
<td>intent(out),</td>
              <td></td>            <td>
              dimension(:, :, -nzgrid:, :)
            </td>
            <td>::</td>
            <td><strong>bpar</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-dist~15"></span>
              character(len=*),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>dist</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-skip_fsa~4"></span>
              logical,
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>skip_fsa</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-get_fields_fluxtube_kxkyzlo"></span> <h3>private  subroutine <a href='../proc/get_fields_fluxtube_kxkyzlo.html'>get_fields_fluxtube_kxkyzlo</a>(g, phi, apar, bpar, dist, skip_fsa)  
</h3></div>
    <div class="card-body">
          
  <p>If we are parallelising over (kx,ky,z) then this subroutine is called
This is the less common version used compared with parallelising over
(vpa, mu). This is NOT the default routine for stella, and the flag
<fields_kxkyz = .True.> must be set to use this routine.
Here we calculate:
   sum_s int dv (J0 * g)
and then call get_phi which divides this by the appropriate gamtot factor
TODO-GA: remove apar from this and make it only needed for EM stella</p><a href="../proc/get_fields_fluxtube_kxkyzlo.html" class="pull-right"><emph>Read more&hellip;</emph></a>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-g~109"></span>
              complex,
            </td>
<td>intent(in),</td>
              <td></td>            <td>
              dimension(:, :, kxkyz_lo%llim_proc:)
            </td>
            <td>::</td>
            <td><strong>g</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-phi~51"></span>
              complex,
            </td>
<td>intent(inout),</td>
              <td></td>            <td>
              dimension(:, :, -nzgrid:, :)
            </td>
            <td>::</td>
            <td><strong>phi</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-apar~35"></span>
              complex,
            </td>
<td>intent(inout),</td>
              <td></td>            <td>
              dimension(:, :, -nzgrid:, :)
            </td>
            <td>::</td>
            <td><strong>apar</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-bpar~32"></span>
              complex,
            </td>
<td>intent(inout),</td>
              <td></td>            <td>
              dimension(:, :, -nzgrid:, :)
            </td>
            <td>::</td>
            <td><strong>bpar</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-dist~16"></span>
              character(len=*),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>dist</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-skip_fsa~5"></span>
              logical,
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>skip_fsa</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-get_phi"></span> <h3>private  subroutine <a href='../proc/get_phi.html'>get_phi</a>(phi, dist, skip_fsa)  
</h3></div>
    <div class="card-body">
          
  <p>The 'phi' variable passed in is:
   sum_s int dv (J0 * g)
This routine divides by the appropriate gamtot factor depending on if we
have kinetic or adiabatic electrons, and also on whether we are using 'g'
or 'h' as our distribution function that we are evolving.
Note that this routine is only called in the Electrostatic, Fluxtube case.</p><a href="../proc/get_phi.html" class="pull-right"><emph>Read more&hellip;</emph></a>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-phi~52"></span>
              complex,
            </td>
<td>intent(inout),</td>
              <td></td>            <td>
              dimension(:, :, -nzgrid:, :)
            </td>
            <td>::</td>
            <td><strong>phi</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-dist~17"></span>
              character(len=*),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>dist</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-skip_fsa~6"></span>
              logical,
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>skip_fsa</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-init_fields_fluxtube"></span> <h3>public  subroutine <a href='../proc/init_fields_fluxtube.html'>init_fields_fluxtube</a>()  
</h3></div>
    <div class="card-body">
          
  <p>Initialise arrays that are needed during the main time advance loop in the
field solve for the flux tube simulations only
These are initialised once and then used throughout the rest of the simulation
   gamtot = 1 - gamma0 = Z^2*n/T * int e^(-v^2) * (1 - J0^2) dv
If using adiabatic electrons then this factor is modified and we use gamtot3
which includes the Boltmann response</p><a href="../proc/init_fields_fluxtube.html" class="pull-right"><emph>Read more&hellip;</emph></a>

  <h4>Arguments</h4>
    <em>None</em>

    </div>
  </div>

        </section>
        <br>



    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              stella
 was developed by The stella team<br>              &copy; 2024 
<br /><small>v0.7-26-gcf608fe7f8</small></p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2024-09-26T10:53:28.392052             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>    

    <!-- MathJax JavaScript
             ================================================== -->
             <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
          jax: ['input/TeX','input/MathML','output/HTML-CSS'],
          extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
          });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

          <script src="../tipuesearch/tipuesearch_content.js"></script>
          <script src="../tipuesearch/tipuesearch_set.js"></script>
          <script src="../tipuesearch/tipuesearch.js"></script>

  </body>
</html>