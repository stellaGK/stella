<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="stella is a flux tube gyrokinetic code for micro-stability and turbulence simulations of strongly magnetised plasma">
    <meta name="author" content="The stella team" >
    <link rel="icon" href="../favicon.png">

    <title>init_stella &ndash; stella</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
      <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">stella </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" href="../page/index.html">Manual</a></li>
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/namelists.html">Namelists</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/programs.html">Programs</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>init_stella
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 0.5% of total for procedures.">197 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/stella.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/stella.f90.html'>stella.f90</a></li>
                <li class="breadcrumb-item"><a href='../program/stella.html'>stella</a></li>
            <li class="breadcrumb-item active" aria-current="page">init_stella</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-bs-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2> subroutine init_stella(istep0, git_commit, git_date)  
</h2>
        <div class="card mb-4">
      <h3 class="card-header card-title bg-light">Uses</h3>
      <div class="card-body">
        <ul class="list-group list-group-flush">
            <li class="list-group-item">
              <ul class="list-inline">
                  <li class="list-inline-item"><a href='../module/ran.html'>ran</a></li>
                  <li class="list-inline-item"><a href='../module/stella_time.html'>stella_time</a></li>
                  <li class="list-inline-item"><a href='../module/dist_fn.html'>dist_fn</a></li>
                  <li class="list-inline-item"><a href='../module/run_parameters.html'>run_parameters</a></li>
                  <li class="list-inline-item"><a href='../module/job_manage.html'>job_manage</a></li>
                  <li class="list-inline-item"><a href='../module/fields_arrays.html'>fields_arrays</a></li>
                  <li class="list-inline-item"><a href='../module/stella_save.html'>stella_save</a></li>
                  <li class="list-inline-item"><a href='../module/dist_redistribute.html'>dist_redistribute</a></li>
                  <li class="list-inline-item"><a href='../module/volume_averages.html'>volume_averages</a></li>
                  <li class="list-inline-item"><a href='../module/physics_parameters.html'>physics_parameters</a></li>
                  <li class="list-inline-item"><a href='../module/species.html'>species</a></li>
                  <li class="list-inline-item"><a href='../module/mp.html'>mp</a></li>
                  <li class="list-inline-item"><a href='../module/geometry.html'>geometry</a></li>
                  <li class="list-inline-item"><a href='../module/zgrid.html'>zgrid</a></li>
                  <li class="list-inline-item"><a href='../module/init_g.html'>init_g</a></li>
                  <li class="list-inline-item"><a href='../module/dissipation.html'>dissipation</a></li>
                  <li class="list-inline-item"><a href='../module/physics_flags.html'>physics_flags</a></li>
                  <li class="list-inline-item"><a href='../module/extended_zgrid.html'>extended_zgrid</a></li>
                  <li class="list-inline-item"><a href='../module/response_matrix.html'>response_matrix</a></li>
                  <li class="list-inline-item"><a href='../module/vpamu_grids.html'>vpamu_grids</a></li>
                  <li class="list-inline-item"><a href='../module/stella_transforms.html'>stella_transforms</a></li>
                  <li class="list-inline-item"><a href='../module/file_utils.html'>file_utils</a></li>
                  <li class="list-inline-item"><a href='../module/fields.html'>fields</a></li>
                  <li class="list-inline-item"><a href='../module/diagnostics.html'>diagnostics</a></li>
                  <li class="list-inline-item"><a href='../module/dist_fn_arrays.html'>dist_fn_arrays</a></li>
                  <li class="list-inline-item"><a href='../module/multibox.html'>multibox</a></li>
                  <li class="list-inline-item"><a href='../module/stella_layouts.html'>stella_layouts</a></li>
                  <li class="list-inline-item"><a href='../module/sources.html'>sources</a></li>
                  <li class="list-inline-item"><a href='../module/kt_grids.html'>kt_grids</a></li>
                  <li class="list-inline-item"><a href='../module/parameters_diagnostics.html'>parameters_diagnostics</a></li>
                  <li class="list-inline-item"><a href='../module/time_advance.html'>time_advance</a></li>
              </ul>
            </li>
        </ul>
      </div>
    </div>


    <p>Initialise stella</p>
<p>Calls the initialisation routines for all the geometry, physics, and
diagnostic modules</p>
<p>initialize mpi message passing
initialize timer
write message to screen with useful info regarding start of simulation
initialize file i/o
read the physics_flags namelist from the input file
read the physics_parameters namelist from the input file
read the zgrid_parameters namelist from the input file and setup the z grid
read the species_knobs namelist from the input file
read the grid option from the kt_grids_knobs namelist in the input file;
depending on the grid option chosen, read the corresponding kt_grids_XXXX_parameters
namelist from the input file and allocate some kx and ky arrays
read the vpamu_grids_parameters namelist from the input file
setup the various data layouts for the distribution function;
e.g., vmu_lo is the layout in which vpa, mu and species may be distributed
amongst processors, depending on the number of phase space points and processors
needs_transforms indicates whether or not FFTs will be needed in the simulation
if FFTs are needed, init_transforms sets up the various FFTW plans
and allocates the necessary arrays
read in the geometry option and any necessary magnetic geometry info
and use it to calculate all of the required geometric coefficients
read species_parameters from input file and use the info to, e.g.,
determine if a modified Boltzmann response is to be used
read init_g_knobs namelist from the input file
and prepare for reading in from restart file if requested
read knobs namelist from the input file
and the info to determine the mixture of implicit and explicit time advance
read layouts_knobs namelist from the input file,
which determines the order of parallelisation within the different layouts
setup the (kx,ky) grids and (x,y) grids, if applicable
finish_init_geometry deallocates various geometric arrays that
were defined locally within the geometry_miller module when using Miller geometry
setup the (vpa,mu) grids and associated integration weights
set up all of the logic needed to do calculations on an extended grid in z.
this extended grid could be due to use of a ballooning angle so that
z goes from -N<em>pi to N</em>pi, or it could be due to the coupling of different
kx modes arising from the twist-and-shift boundary condition
when doing a volume average using Fourier coefficients, the
ky=0 mode gets a different weighting than finite ky modes, due
to the reality condition being imposed; init_volume_averages accounts for this
allocates and initialises kperp2, vperp2 and arrays needed
for gyro-averaging (j0 and j1 or equivalents)
sets up the mappings between different layouts, needed
to redistribute data when going from one layout to another
read dissipation namelist from the input file and print information
about chosen options to stdout
allocate and initialise time-independent arrays needed to
solve the field equations; e.g., sum_s (Z_s^2 n_s / T_s)*(1-Gamma0_s)
initialise the distribution function in the kxkyz_lo and store in gvmu
use mapping from kxkyz_lo to vmu_lo to get a copy of g that has ky, kx and z local to each core;
stored in gnew and copied to gold
if initializing from restart file, set the initial time step size appropriately
set the internal time step size variable code_dt from the input variable delt
allocate and calculate arrays needed for the mirror, parallel streaming,
magnetic drifts, gradient drive, etc. terms during time advance
get initial field from initial distribution function
fill in the boundary regions using auxilliary simulations if using
multibox, or zero it out if using Dirichlet boundary conditions
rescale to phiinit if just beginning a new run</p>
<p>read diagnostics_knob namelist from the input file,
open ascii output files and initialise the neetcdf file with extension .out.nc
initialise the code_time
Add a header to the output file
stop the timing of the initialization</p>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-istep0~5"></span>
              integer,
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>istep0</strong></td>
            <td>
                <p>Starting timestep: zero unless the simulation has been restarted</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-git_commit~5"></span>
              character(len=40),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>git_commit</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-git_date~5"></span>
              character(len=10),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>git_date</strong></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    <br>


    
    

    
    



    
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              stella
 was developed by The stella team<br>              &copy; 2024 
<br /><small>v0.5.1-365-gf7e8e47374</small></p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2024-09-04T15:06:28.413369             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>    

    <!-- MathJax JavaScript
             ================================================== -->
             <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
          jax: ['input/TeX','input/MathML','output/HTML-CSS'],
          extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
          });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

          <script src="../tipuesearch/tipuesearch_content.js"></script>
          <script src="../tipuesearch/tipuesearch_set.js"></script>
          <script src="../tipuesearch/tipuesearch.js"></script>

  </body>
</html>