<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="stella is a flux tube gyrokinetic code for micro-stability and turbulence simulations of strongly magnetised plasma">
    <meta name="author" content="The stella team" >
    <link rel="icon" href="../favicon.png">

    <title>Writing Documentation &ndash; stella</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">stella </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>README</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>Writing Documentation</h1>
    <div class="row">
    <div class="col-lg-12">
    <div class="well well-sm" style="min-height: 40px;">
      <ul class="list-inline" style="margin-bottom:0px; display:inline">
<!--
-->
      </ul>
        <ol class="breadcrumb in-well">
         <li><a href='../page/index.html'>README</a></li>
         <li class="active">Writing Documentation</li>
      </ol>
    </div>
    </div>
    </div>
  </div>
  
  <div class="row">
    <div class="col-md-9 col-md-push-3" id='text'>
      <div class="toc">
<ul>
<li><a href="#in-source-documentation">In-source documentation</a></li>
<li><a href="#out-of-source-documentation">Out-of-source documentation</a><ul>
<li><a href="#add-a-new-page">Add a new page</a></li>
<li><a href="#converting-latex-to-markdown">Converting LaTeX to Markdown</a></li>
<li><a href="#linking-to-sections">Linking to sections</a></li>
<li><a href="#linking-to-source-documentation">Linking to source documentation</a></li>
<li><a href="#building-the-documentation-locally">Building the documentation locally</a></li>
<li><a href="#cheat-sheet">Cheat sheet</a></li>
</ul>
</li>
</ul>
</div>
<p>stella uses <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a> to automatically build this online documentation. There are two
sorts of documentation that get built: in-source and out-of-source. This page describes
how to write both sorts. The website will get built automatically when your changes are
merged into <code>master</code>.</p>
<h1 id="in-source-documentation">In-source documentation</h1>
<p>Special Fortran comments of the form <code>!&gt;</code> are used to document procedures, variables and
programs using <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>. These comments are sometimes called "docstrings". FORD can
understand these comments before, after or in-line with the thing to be documented, but
the preferred style in stella is to put the comment before the entity, like in this example:</p>
<div class="codehilite"><pre><span></span><code><span class="c">!&gt; This is module-level documentation, describing the overall purpose of this module.</span>
<span class="c">!&gt; Documentation comments can be over several lines.</span>
<span class="k">module </span><span class="n">my_module</span><span class="w"></span>
<span class="w">    </span><span class="k">implicit none</span><span class="w"></span>

<span class="w">    </span><span class="c">!&gt; Docstrings can go on derived types</span>
<span class="w">    </span><span class="k">type</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">my_type</span><span class="w"></span>
<span class="w">        </span><span class="c">!&gt; Docstrings can include in-line LaTeX like this: \(R\)</span>
<span class="w">        </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">R_major</span><span class="w"></span>
<span class="w">        </span><span class="c">!&gt; Or as a displayed equation:</span>
<span class="w">        </span><span class="c">!&gt;   $$\frac{\partial R}{\partial \psi}$$</span>
<span class="w">        </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">R_major_prime</span><span class="w"></span>
<span class="w">        </span><span class="c">!&gt; Code-formatting uses `backticks`</span>
<span class="w">        </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n_R</span><span class="w"></span>
<span class="w">    </span><span class="k">end type </span><span class="n">my_type</span><span class="w"></span>

<span class="k">contains</span><span class="w"></span>

<span class="w">    </span><span class="c">!&gt; We can document functions/subroutines</span>
<span class="w">    </span><span class="kt">real </span><span class="k">function </span><span class="n">gradient</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="w"> </span><span class="n">psi</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="c">!&gt; In order to separate the docstring for each argument...</span>
<span class="w">        </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">R</span><span class="w"></span>
<span class="w">        </span><span class="c">!&gt; ...it&#39;s best to have each argument on its own line</span>
<span class="w">        </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">psi</span><span class="w"></span>
<span class="w">    </span><span class="k">end function </span><span class="n">gradient</span><span class="w"></span>

<span class="k">end module </span><span class="n">my_module</span><span class="w"></span>
</code></pre></div>

<p>The <a href="https://github.com/Fortran-FOSS-Programmers/ford/wiki">FORD wiki</a> has more documentation on how to write these docstrings. Please
note that while FORD accepts <code>!&lt;</code> comments <em>after</em> or in-line with the thing to be
documented, the stella style is to stick to <code>!&gt;</code> <em>before</em> and on a separate line.</p>
<h1 id="out-of-source-documentation">Out-of-source documentation</h1>
<p>As well as the code documentation, we also have some extra documentation. The source for
these pages in still kept in the stella git repository, and are built into the website at the
same time. These extra pages are written in <a href="https://www.markdownguide.org">Markdown</a>, with some
extensions (see <a href="https://python-markdown.github.io/">the Python markdown implementation</a>). There's a short
<a href="#cheat-sheet">cheat sheet</a> at the bottom of this page.</p>
<h2 id="add-a-new-page">Add a new page</h2>
<p>All the out-of-source documentation is under <code>docs/pages</code>. FORD converts the directory
hierarchy in to a hierarchy of HTML pages. To add a new page, simply create a new file
under <code>docs/pages</code>, and use the file extension <code>.md</code>. <strong>Your file must contain the
following at the very top</strong>:</p>
<div class="codehilite"><pre><span></span><code>---
<span class="gu">title: Page title</span>
<span class="gu">---</span>
</code></pre></div>

<p>Without this metadata section, FORD will not parse the file as part of the documentation.</p>
<p>In this metadata section, you can also have <code>author</code> and <code>date</code> items.</p>
<p>Another useful feature, is put <code>[TOC]</code> on its own line after the metadata section. This
produces a hyperlinked table of contents.</p>
<p>See the <a href="https://github.com/Fortran-FOSS-Programmers/ford/wiki/Writing-Pages">FORD wiki</a> for a more detailed description.</p>
<h2 id="converting-latex-to-markdown">Converting LaTeX to Markdown</h2>
<p>The easiest way to convert LaTeX to Markdown is to use <a href="https://pandoc.org/">Pandoc</a>. This nifty tool
understands tons of text formats and can convert between them easily, and will get the
vast majority of the heavy lifting done for you. Due to the complexities of LaTeX and the
simplicity of Markdown, it may require some manual tidying up after the initial
conversion.</p>
<p>To get started, run Pandoc:</p>
<div class="codehilite"><pre><span></span><code>$ pandoc --standalone --from<span class="o">=</span>latex --to<span class="o">=</span>gfm my_docs.tex --output docs/pages/my_docs.md
</code></pre></div>

<p>FORD is a bit fussier about the metadata section at the top, compared to what Pandoc
produces, so you may need to manually adjust it.</p>
<p>Acceptable:</p>
<div class="codehilite"><pre><span></span><code>---
title: On the Electrodynamics of Moving Bodies
<span class="gu">author: A. Einstein</span>
<span class="gu">---</span>
</code></pre></div>

<p>Unacceptable:</p>
<div class="codehilite"><pre><span></span><code>---
title: Does the Inertia of a Body Depend upon its Energy Content?
author: 
<span class="gu">- &#39;A. Einstein&#39;</span>
<span class="gu">---</span>
</code></pre></div>

<p>which is a possible output from Pandoc.</p>
<p>FORD can render LaTeX included in the markdown, with just a couple of gotchas. The most
important one is that in-line maths <strong>must</strong> use <code>\(...\)</code> rather than <code>$...$</code>. Displayed
equations can be written between <code>$$...$$</code>, but note that this does not number the
resulting equation.</p>
<p>Normal <code>\begin{equation} ... \end{equation}</code> environments can be used to get numbered
equations, along with <code>\label{eq:something}</code> and <code>\eqref{eq:something}</code> to refer to them.</p>
<p>This example:</p>
<div class="codehilite"><pre><span></span><code><span class="nv">To</span><span class="w"> </span><span class="nv">obtain</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">distribution</span><span class="w"> </span><span class="nv">function</span><span class="w"> </span><span class="nv">at</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="nv">time</span><span class="w"> </span><span class="k">step</span><span class="p">,</span><span class="w"> </span>\<span class="p">(</span><span class="nv">g</span><span class="o">^</span><span class="p">{</span><span class="nv">n</span><span class="o">+</span><span class="mi">1</span><span class="p">}</span>\<span class="p">),</span><span class="w"> </span><span class="nv">we</span><span class="w"> </span><span class="nv">could</span><span class="w"> </span><span class="nv">combine</span><span class="w"></span>
<span class="nv">these</span><span class="w"> </span><span class="nv">equations</span><span class="w"></span>

<span class="p">$$</span><span class="nv">A</span><span class="w"> </span><span class="nv">g</span><span class="o">^</span><span class="p">{</span><span class="nv">n</span><span class="o">+</span><span class="mi">1</span><span class="p">}</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">B</span><span class="w"> </span><span class="nv">g</span><span class="o">^</span><span class="p">{</span><span class="nv">n</span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">DF</span><span class="o">^</span><span class="p">{</span><span class="o">-</span><span class="mi">1</span><span class="p">}</span><span class="nv">Gg</span><span class="o">^</span><span class="p">{</span><span class="nv">n</span><span class="o">+</span><span class="mi">1</span><span class="p">}</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">E</span>\<span class="nv">phi</span><span class="o">^</span><span class="p">{</span><span class="nv">n</span><span class="p">},$$</span><span class="w"></span>
</code></pre></div>

<p>is rendered as:</p>
<blockquote>
<p>To obtain the distribution function at the next time step, <script type="math/tex">g^{n+1}</script>, we could combine
these equations</p>
<p>
<script type="math/tex; mode=display">A g^{n+1} + B g^{n} = DF^{-1}Gg^{n+1} + E\phi^{n},</script>
</p>
</blockquote>
<p>while</p>
<div class="codehilite"><pre><span></span><code>\<span class="nv">begin</span>{<span class="nv">equation</span>}
<span class="nv">F</span> \<span class="nv">phi</span><span class="o">^</span>{<span class="nv">n</span><span class="o">+</span><span class="mi">1</span>} <span class="o">=</span> <span class="nv">G</span> <span class="nv">g</span><span class="o">^</span>{<span class="nv">n</span><span class="o">+</span><span class="mi">1</span>}
\<span class="nv">label</span>{<span class="nv">eq</span>:<span class="nv">QN</span>}
\<span class="k">end</span>{<span class="nv">equation</span>}

\<span class="nv">eqref</span>{<span class="nv">eq</span>:<span class="nv">QN</span>} <span class="nv">is</span> <span class="nv">the</span> <span class="nv">quasi</span><span class="o">-</span><span class="nv">neutrality</span> <span class="nv">equation</span>
</code></pre></div>

<p>is rendered as</p>
<blockquote>
<p>
<script type="math/tex; mode=display">\begin{equation}
F \phi^{n+1} = G g^{n+1}
\label{eq:QN}
\end{equation}</script>
</p>
<p>\eqref{eq:QN} is the quasi-neutrality equation</p>
</blockquote>
<h2 id="linking-to-sections">Linking to sections</h2>
<p>Section titles within a page get converted into HTML "anchors" which can be linked to. The
section names are first converted to lowercase and spaces replaced with hyphens. To link
to a section, use the usual link syntax and add <code>#</code> in front of the converted section
name.</p>
<p>This:</p>
<div class="codehilite"><pre><span></span><code>Link to [<span class="nt">this section</span>](<span class="na">#linking-to-sections</span>)
</code></pre></div>

<p>becomes:</p>
<blockquote>
<p>Link to <a href="#linking-to-sections">this section</a></p>
</blockquote>
<h2 id="linking-to-source-documentation">Linking to source documentation</h2>
<p>Linking directly to the code documentation is possible using FORD's syntax, which is
described
<a href="https://github.com/Fortran-FOSS-Programmers/ford/wiki/Writing-Documentation#links">here</a>:</p>
<p>This:</p>
<div class="codehilite"><pre><span></span><code>The two linear steps \(L\) are performed by the function <a href="../module/dist_fn.html">dist_fn</a> in <a>dist_fn.fpp</a>
</code></pre></div>

<p>is rendered as:</p>
<blockquote>
<p>The two linear steps <script type="math/tex">L</script> are performed by the function <a href="../module/dist_fn.html">dist_fn</a> in <a>dist_fn.fpp</a></p>
</blockquote>
<h2 id="building-the-documentation-locally">Building the documentation locally</h2>
<p><a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a> can be easily installed with <code>pip</code>:</p>
<div class="codehilite"><pre><span></span><code>$ pip3 install --user ford
</code></pre></div>

<p>After installing FORD, simply run <code>make doc</code>. This will build the documentation under
<code>docs/html</code>:</p>
<div class="codehilite"><pre><span></span><code>$ make doc
</code></pre></div>

<p>Then open <code>docs/html/index.html</code> in your favourite browser.</p>
<h2 id="cheat-sheet">Cheat sheet</h2>
<p><a href="https://www.markdownguide.org">See here</a> for a comprehensive guide to Markdown.</p>
<p>Here's a quick little cheat sheet:</p>
<table>
<thead>
<tr>
<th>Syntax</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Heading</td>
<td><code># Top-level</code></td>
</tr>
<tr>
<td></td>
<td><code>## Section</code></td>
</tr>
<tr>
<td></td>
<td><code>### Sub-section</code></td>
</tr>
<tr>
<td>Bold</td>
<td><code>**bold text**</code></td>
</tr>
<tr>
<td>Italic</td>
<td><code>*italicised text*</code></td>
</tr>
<tr>
<td>Code</td>
<td><code>`code`</code></td>
</tr>
<tr>
<td>Blockquote</td>
<td><code>&gt; Block quote</code></td>
</tr>
<tr>
<td>Ordered lists</td>
<td><code>1. First item</code></td>
</tr>
<tr>
<td></td>
<td><code>2. Second item</code></td>
</tr>
<tr>
<td></td>
<td><code>3. Third item</code></td>
</tr>
<tr>
<td>Unordered lists</td>
<td><code>- First item</code></td>
</tr>
<tr>
<td></td>
<td><code>- Second item</code></td>
</tr>
<tr>
<td></td>
<td><code>- Third item</code></td>
</tr>
<tr>
<td>Link</td>
<td><code>[title](www.example.com)</code></td>
</tr>
<tr>
<td>Image</td>
<td><code>![alt text](image.jpg)</code></td>
</tr>
</tbody>
</table>
<!-- Local Variables: -->
<!-- mode: gfm -->
<!-- fill-column: 90 -->
<!-- End: -->
    </div>
    <div class="col-md-3 col-md-pull-9">
      <hr class="visible-xs visible-sm">
        <div class="well toc">
          <ul class="nav nav-stacked nav-pills">
            <li role="presentation" class="title"><a href='../page/index.html'>README</a></li>
          </ul>
          <hr>
          <ul class="nav nav-stacked nav-pills">
            <li role="presentation">
            <a href='../page/./CMake.html'>CMake in stella</a>
            </li>
            <li role="presentation" class="disabled">
            <a href='../page/./writing_documentation.html'>Writing Documentation</a>
            </li>
          </ul>
        </div>
    </div>
  </div>
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>stella was developed by The stella team<br>&copy; 2022 
<br /><small>v0.5.1-109-gdd5de5b96</small></p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2022-09-07T09:37:53.470962           </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>